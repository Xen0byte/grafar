<!doctype html>

<html lang="en">
<head>
	<title>Grafar.js Buffer test suite</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
</head>

<body>
	<script src="../src/grafar.js"></script>
	<script src="../src/core/pool.js"></script>
	<script src="../src/core/misc.js"></script>
	<script src="../src/math/array_utils.js"></script>
	<script src="../src/math/set.js"></script>
	<script src="../src/core/fn_utils.js"></script>
	<script src="../src/core/buffer.js"></script>

	<script>

        console.log('start tests');

        // construction
        var x = grafar.buffer();
        console.assert(x.length === 0, 'Len init');
        console.assert(x.array instanceof Float32Array && x.array.length === 0,
            'Data is an empty F32A');

		var y = grafar.buffer(10);
        console.assert(y.length === 10, 'Len set');
        console.assert(y.array instanceof Float32Array && y.array.length === 10,
            'Data is an empty F32A');

		var z = grafar.buffer(Uint32Array);
        console.assert(z.length === 0, 'Len set');
        console.assert(z.array instanceof Uint32Array && z.array.length === 0,
            'Data is an empty F32A');

		var w = grafar.buffer(Uint32Array, 10);
        console.assert(w.length === 10, 'Len set');
        console.assert(w.array instanceof Uint32Array && w.array.length === 10,
            'Data is an empty F32A');

		// mutation
        x.resize(10);
        console.assert(x.array instanceof Float32Array && x.array.length === 10,
            'Resized');
        console.assert(x.array.length === x.length, 'Length in sync');

        // map
        var y = grafar.buffer().resize(10);
        grafar.mapify(function(x) {return Math.random(); })([x], y);
        console.assert(y.array[3] !== 0, 'Random map ');
        y = grafar.mapify(function(x) {return Math.random(); })([x], y);
        console.assert(y instanceof grafar.Buffer2, 'Map is chainable');

        console.log('end tests');
	</script>
</body>
</html>
