<!doctype html>

<html lang="en">
<head>
	<title>testbox</title>

	<link rel="stylesheet" type="text/css" href="stylesheets/testbox_style.css" media="screen" />

    <meta http-equiv="Content-Type" content="text/html; charset=windows-1251">
</head>

<body>
	<div id = "render">

	<script type="text/javascript" src="../build/grafar.js"></script>
	<script type="text/javascript">
        var pan3d = new grafar.Panel(document.getElementById('render')),
            bld1 = new grafar.Object().pin(pan3d),
            pi = Math.PI,
            segAng = 3 * pi / 2,
            seg = 9,
            angRescale = 2 * pi / segAng / seg,
            power = 2,
            hScale = 1/3;

        pan3d.camera.position.set(-1.3, .47, .7);

        const r = bld1.extern(grafar.logseq(0, 1, 20, 'r'));
        const phi = bld1.extern(grafar.range(-segAng / 2, segAng / 2, 20, 'phi'));
        const rep = bld1.extern(grafar.seq(0, 2 * pi, seg, 'rep', true));
        const layer = bld1.extern(grafar.ints(0, 1, 'layer'));

        const z = bld1.map('z', [r, phi, rep, layer],
            (r, phi, _, layer) => hScale * Math.pow(r, power) * Math.cos(phi) + layer / 50
        );
        const x = bld1.map('x', [r, phi, rep, layer],
            (r, phi, rep, _) => Math.cos(rep + angRescale * phi) * r
        );
        const y = bld1.map('y', [r, phi, rep, layer],
            (r, phi, rep, _) => Math.sin(rep + angRescale * phi) * r
        );

        bld1.colorize({ using: '', as: grafar.Style.constantColor(0 / 255, 140 / 255, 240 / 255) })
            .refresh();
	</script>

	</body>
</html>
